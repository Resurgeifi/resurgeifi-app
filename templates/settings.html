{% extends "base.html" %}
{% block title %}Settings | Resurgifi{% endblock %}

{% block content %}
<div class="main-content" style="max-width: 600px; margin: 2rem auto; text-align: center;">
  <h1>âš™ï¸ Settings</h1>
  <p class="mantra">Update your journey settings and nickname below.</p>

  <form method="POST" action="/settings" style="margin-top: 2rem;">
    <div class="card-dark" style="padding: 2rem;">

      <!-- ğŸŒ€ Journey Selection (Multi) -->
      <label for="theme_choice" style="font-size: 1.2rem; display: block; margin-bottom: 1rem;"><strong>Your Journey</strong></label>
      <select name="theme_choice" id="theme_choice" class="global-button" multiple size="7" style="width: 100%; padding: 0.6rem; font-size: 1rem; border-radius: 8px;">
        <option value="Major loss or grieving" {% if "Major loss or grieving" in theme_choice %}selected{% endif %}>ğŸ’” Grief</option>
        <option value="Anxiety or fear" {% if "Anxiety or fear" in theme_choice %}selected{% endif %}>ğŸŒªï¸ Anxiety</option>
        <option value="Addiction" {% if "Addiction" in theme_choice %}selected{% endif %}>ğŸ’Š Addiction</option>
        <option value="Depression or emptiness" {% if "Depression or emptiness" in theme_choice %}selected{% endif %}>ğŸŒ«ï¸ Depression</option>
        <option value="Low self-worth" {% if "Low self-worth" in theme_choice %}selected{% endif %}>ğŸª Self-Worth</option>
        <option value="Trauma or PTSD" {% if "Trauma or PTSD" in theme_choice %}selected{% endif %}>ğŸ”¥ Trauma</option>
        <option value="Emotional growth" {% if "Emotional growth" in theme_choice %}selected{% endif %}>ğŸŒ± Emotional Growth</option>
      </select>

      <!-- ğŸ“… Start Date -->
      <label for="journey_start_date" style="font-size: 1.2rem; display: block; margin-top: 2rem;"><strong>ğŸŒ„ When did your journey begin?</strong></label>
      <input type="date" 
             name="journey_start_date" 
             value="{{ journey_start_date }}" 
             min="1950-01-01" 
             max="{{ datetime.utcnow().strftime('%Y-%m-%d') }}"
             style="margin-top: 0.5rem; padding: 0.6rem; width: 100%; font-size: 1rem; border-radius: 8px;">

      <!-- ğŸ“ Nickname -->
      <label for="nickname" style="font-size: 1.2rem; display: block; margin-top: 2rem;"><strong>ğŸ“ Your Nickname</strong></label>
      <input type="text" name="nickname" value="{{ nickname }}" placeholder="What do people call you?" style="margin-top: 0.5rem; padding: 0.6rem; width: 100%; font-size: 1rem; border-radius: 8px;">

      <!-- ğŸ•’ Time Zone -->
      <label for="timezone" style="font-size: 1.2rem; display: block; margin-top: 2rem;"><strong>ğŸ•’ Your Time Zone</strong></label>
      <select name="timezone" id="timezone" class="global-button" style="width: 100%; padding: 0.6rem; font-size: 1rem; border-radius: 8px;">
        <option value="America/New_York" {% if timezone == "America/New_York" %}selected{% endif %}>Eastern (US)</option>
        <option value="America/Chicago" {% if timezone == "America/Chicago" %}selected{% endif %}>Central (US)</option>
        <option value="America/Denver" {% if timezone == "America/Denver" %}selected{% endif %}>Mountain (US)</option>
        <option value="America/Los_Angeles" {% if timezone == "America/Los_Angeles" %}selected{% endif %}>Pacific (US)</option>
        <option value="America/Anchorage" {% if timezone == "America/Anchorage" %}selected{% endif %}>Alaska</option>
        <option value="Pacific/Honolulu" {% if timezone == "Pacific/Honolulu" %}selected{% endif %}>Hawaii</option>
        <option value="UTC" {% if timezone == "UTC" %}selected{% endif %}>UTC</option>
      </select>

      <!-- ğŸ” Moved Visibility Settings Note -->
      <p style="margin-top: 2rem; font-size: 0.95rem; color: #bbb;">
        Want to manage who can see your journey or city/state?  
        <a href="/profile" style="color: #ffdd99; text-decoration: underline;">Update your profile visibility settings here</a>.
      </p>

      <!-- âœ… Save -->
      <button type="submit" class="global-button" style="margin-top: 1.5rem;">ğŸ’¾ Save Settings</button>
    </div>
  </form>

  <a class="dropdown-item" href="{{ url_for('blocked_users') }}">Manage Blocked Users</a>

  <div class="card-dark" style="padding: 1.5rem; margin-top: 2rem;">
    <p class="mantra">Want to help us improve Resurgifi?</p>
    <a href="/feedback" class="global-button">ğŸ“£ Leave Feedback</a>
  </div>

  <form action="{{ url_for('logout') }}" method="get">
    <div class="card-dark" style="padding: 1.5rem; margin-top: 2rem;">
      <button type="submit" class="global-button" style="background-color: #c62828; color: #fff;">Log Out</button>
    </div>
  </form>
</div>
{% endblock %}

