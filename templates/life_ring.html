{% extends "base.html" %}
{% block title %}Life Ring | Resurgifi{% endblock %}

{% block content %}
<div class="main-content" style="max-width: 700px; margin: 0 auto; text-align: center;">
  <h1>🛟 Life Ring: Real-World Support</h1>

  <p class="mantra" style="margin-bottom: 2rem;">
    When virtual help isn't enough, we guide you toward a real-world hand. One question at a time.
  </p>

  <button onclick="startRescueFlow()" class="global-button" style="background-color: #e11d48;">
    Begin Rescue Check-In
  </button>

  <!-- 🔄 Rescue Modal Container -->
  <div id="rescueModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <p id="questionText" class="life-question">Loading...</p>
      <div id="responseButtons"></div>
    </div>
  </div>

  <!-- 🎯 Final Match Display -->
  <div id="rescueResult" class="entry-box" style="display: none; margin-top: 3rem;">
    <h3 id="matchName">Clear Horizon Recovery</h3>
    <p><strong>Type:</strong> <span id="matchType">Dual Diagnosis, Inpatient + Outpatient</span></p>
    <p><strong>Location:</strong> <span id="matchLocation">Nationwide (Based in Florida)</span></p>
    <p id="matchQuote" style="font-style: italic;">“They know what rock bottom feels like — and how to build from it.”</p>
    <div class="final-action-buttons">
      <a id="matchCall" class="global-button">📞 Call Now</a>
      <a id="matchVisit" class="global-button" target="_blank">🌐 Visit Website</a>
    </div>
  </div>

  <!-- 🏥 Partner Treatment Centers -->
  <div style="margin-top: 3rem; padding: 2rem; background-color: #2a2d3a; border-radius: 15px; color: #fff;">
    <h3 style="margin-bottom: 1.5rem;">🌍 Partner Treatment Centers</h3>

    <!-- ✅ Primary Partner: California Behavioral Health -->
    <div style="display: flex; flex-wrap: wrap; background-color: #1f2230; padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem; align-items: center;">
      <img src="{{ url_for('static', filename='images/partners/cbh-logo.png') }}" alt="CBH Logo" style="height: 80px; margin-right: 1.5rem;">
      <div style="flex: 1;">
        <h4 style="margin: 0; color: #aad1ff;">California Behavioral Health</h4>
        <p style="margin: 0.25rem 0;">37066 Bankside Drive, Cathedral City, CA 92234</p>
        <p style="margin: 0.25rem 0;">📞 <a href="tel:+18883551676" style="color: #7cdedc;">(888) 355-1676</a></p>
        <p style="margin: 0.25rem 0;">✉️ <a href="mailto:info@cabehavioral.com" style="color: #7cdedc;">info@cabehavioral.com</a></p>
        <a href="https://cabehavioral.com" target="_blank" style="color: #7cdedc;">cabehavioral.com</a>

        <p style="font-style: italic; margin-top: 1rem; color: #ccc;">
          “They helped me detox safely and reminded me I still had a future. I was seen — not just treated.”
        </p>
        <span style="display: inline-block; background-color: #6b21a8; padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 0.9rem;">Inpatient Detox & Treatment</span>
      </div>
    </div>

    <!-- 🔁 Secondary Partner: Engage Wellness -->
    <div style="display: flex; flex-wrap: wrap; background-color: #1f2230; padding: 1.5rem; border-radius: 12px; align-items: center;">
      <img src="{{ url_for('static', filename='images/partners/engage-logo.png') }}" alt="Engage Wellness Logo" style="height: 80px; margin-right: 1.5rem;">
      <div style="flex: 1;">
        <h4 style="margin: 0; color: #aad1ff;">Engage Wellness</h4>
        <p style="margin: 0.25rem 0;">164 Great Rd, Acton, MA 01720</p>
        <p style="margin: 0.25rem 0;">📞 <a href="tel:+19786999786" style="color: #7cdedc;">(978) 699-9786</a></p>
        <p style="margin: 0.25rem 0;">✉️ <a href="mailto:help@engagewellnessnow.com" style="color: #7cdedc;">help@engagewellnessnow.com</a></p>
        <a href="https://engagewellnessnow.com" target="_blank" style="color: #7cdedc;">engagewellnessnow.com</a>

        <p style="font-style: italic; margin-top: 1rem; color: #ccc;">
          “Engage gave me structure without walls. I felt supported and still got to rebuild life on the outside.”
        </p>
        <span style="display: inline-block; background-color: #0284c7; padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 0.9rem;">Intensive Outpatient Program (IOP)</span>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
const rescueQuestions = [
  {
    key: "need",
    q: "What are you seeking help for?",
    options: ["Detox", "Mental Health", "Substance Use", "Grief / Loss", "Just Exploring"]
  },
  {
    key: "care_type",
    q: "What level of care do you think you need?",
    options: ["Inpatient", "Outpatient", "Not Sure"]
  },
  {
    key: "insurance",
    q: "Do you have insurance?",
    options: ["Yes", "No", "Not Sure"]
  },
  {
    key: "region",
    q: "Where are you located?",
    options: ["East Coast", "Midwest", "West Coast", "South", "Nationwide"]
  }
];

const rescueMatch = {
  name: "Clear Horizon Recovery",
  type: "Dual Diagnosis, Inpatient + Outpatient",
  location: "Nationwide (Based in Florida)",
  quote: "They know what rock bottom feels like — and how to build from it.",
  phone: "tel:+18885559999",
  website: "https://clearhorizonrecovery.com/?src=resurgifi"
};

let currentStep = 0;
let userAnswers = {};

function startRescueFlow() {
  currentStep = 0;
  userAnswers = {};
  document.getElementById("rescueModal").style.display = "flex";
  showQuestion();
}

function showQuestion() {
  const qBlock = rescueQuestions[currentStep];
  if (!qBlock) {
    showRescueMatch();
    return;
  }

  document.getElementById("questionText").textContent = qBlock.q;
  const buttonArea = document.getElementById("responseButtons");
  buttonArea.innerHTML = "";

  qBlock.options.forEach(option => {
    const btn = document.createElement("button");
    btn.textContent = option;
    btn.className = "global-button";
    btn.style.margin = "0.5rem";
    btn.onclick = () => {
      userAnswers[qBlock.key] = option;
      currentStep++;
      if (currentStep < rescueQuestions.length) {
        showQuestion();
      } else {
        showRescueMatch();
      }
    };
    buttonArea.appendChild(btn);
  });
}

function showRescueMatch() {
  const match = rescueMatch;

  document.getElementById("rescueModal").style.display = "none";
  document.getElementById("rescueResult").style.display = "block";
  document.getElementById("matchName").textContent = match.name;
  document.getElementById("matchType").textContent = match.type;
  document.getElementById("matchLocation").textContent = match.location;
  document.getElementById("matchQuote").textContent = "“" + match.quote + "”";
  document.getElementById("matchCall").setAttribute("href", match.phone);
  document.getElementById("matchVisit").setAttribute("href", match.website);
}
</script>

<style>
.modal-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0, 0, 0, 0.85);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.modal-content {
  background: #f6e7c1;
  color: #1f3e36;
  padding: 2rem;
  border-radius: 14px;
  max-width: 90%;
  text-align: center;
  box-shadow: 0 0 15px #000;
}

.life-question {
  font-size: 1.4rem;
  font-weight: 600;
  margin-bottom: 1.5rem;
  color: #1f3e36;
}

#responseButtons {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 1rem;
}

.final-action-buttons {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 1rem;
  margin-top: 1.5rem;
}

.final-action-buttons a {
  flex: 1 1 160px;
  text-align: center;
  max-width: 240px;
}
</style>
{% endblock %}




