{% extends "base.html" %}
{% block title %}Today's Quest | Resurgifi{% endblock %}

{% block content %}
<!-- üåå Cinematic Flash Background -->
<div id="questFlash" class="quest-flash" onanimationend="removeQuestFlash()">
  <div class="quest-quote">
    ‚ÄúWelcome to the first Quest in the Beta version of Resurgifi. You are about to enter your State of Inner.‚Äù
  </div>
</div>

<!-- üß† Quest Prompt -->
<div class="quest-card">
  <h2 class="quest-title">Today‚Äôs Quest</h2>
  <p class="quest-prompt">
    When you open your eyes inside your State of Inner, what emotion greets you? Share what you‚Äôre feeling right now. Try and be specific about your feelings and why you're here.
  </p>
  <form method="POST" action="{{ url_for('run_quest', quest_id=1) }}">
    <textarea id="reflectionInput" name="reflection" required placeholder="Type your answer here..." class="quest-textarea" oninput="checkInput()"></textarea>
    <button id="submitBtn" type="submit" class="global-button" disabled>Submit Result</button>
  </form>
</div>

<!-- üéØ Interaction Fix Script -->
<script>
  function removeQuestFlash() {
    const flash = document.getElementById("questFlash");
    if (flash) flash.remove();
  }

  function checkInput() {
    const input = document.getElementById("reflectionInput");
    const button = document.getElementById("submitBtn");
    button.disabled = input.value.trim() === "";
  }
</script>

<!-- üé® Styling -->
<style>
.quest-flash {
  position: fixed;
  top: 0; left: 0; width: 100%; height: 100%;
  background: radial-gradient(circle, #000000 20%, #1a1a1a 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  animation: fadeOut 8s ease forwards;
}
.quest-quote {
  color: #f6e7c1;
  font-size: 1.8rem;
  font-weight: 300;
  text-align: center;
  max-width: 600px;
  padding: 2rem;
  animation: fadeInText 3s ease forwards;
}
@keyframes fadeOut {
  0% { opacity: 1; }
  95% { opacity: 1; }
  100% { opacity: 0; }
}
@keyframes fadeInText {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}
.quest-card {
  margin-top: 8rem;
  background: #2a2d3a;
  padding: 2rem;
  border-radius: 14px;
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
  box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
  text-align: center;
}
.quest-title {
  font-size: 1.6rem;
  color: #f6e7c1;
  margin-bottom: 1rem;
}
.quest-prompt {
  color: #ccc;
  font-size: 1.1rem;
  margin-bottom: 1.5rem;
}
.quest-textarea {
  width: 100%;
  height: 120px;
  border-radius: 10px;
  border: 2px solid #1e2d2b;
  background: #f6e7c1;
  color: #1f3e36;
  padding: 1rem;
  font-size: 1rem;
  margin-bottom: 1rem;
}
.global-button[disabled] {
  opacity: 0.5;
  pointer-events: none;
}
</style>
{% endblock %}
